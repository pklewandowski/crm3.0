function create_post(){$("form#schedule-form #id_schedule-mode").val($("form#schedule-form #basic_form_container").is(":visible")?"basic":"advanced");$.ajax({url:"/schedule/schedule-add/",type:"POST",data:$("form#schedule-form").serialize(),success:function(b){resetCalendarMode();$("#calendar").fullCalendar("refetchEvents");$("#addScheduleFormModal").modal("toggle");var a=!$("form#schedule-form #id").val()?"Pomyślnie dodano zdarzenie!":"Pomyślnie zaktualizowano zdarzenie!";swal({title:a,text:".",type:"info",confirmButtonText:"ok"})},error:function(a){var b=a.responseJSON;swal({title:"Błąd!",text:b.errmsg,type:"error",confirmButtonText:"ok"});if(typeof b.form_errors!=="undefined"){if(typeof b.form_errors.ScheduleForm!=="undefined"){$.each(b.form_errors.ScheduleForm,function(d,g){var f=$("#id_schedule-"+d).closest("div.form-group");f.addClass("form-field-error");var h="";$.each(g,function(j,k){h+="<li>"+k+"</li>"});f.append('<ul class="errorlist">'+h+"<ul>");var c=$("#addScheduleFormModal").find("#error_list");c.text("Wystąpiły błędy!");c.show(200)})}}}})}function getEventData(b,a){$.ajax(a,{dataType:"json",method:"POST",data:{id:b.id,csrfmiddlewaretoken:csrf_token},success:function(d){if(d.status!=="OK"){swal({title:"Błąd!",text:d.errMSG,type:"error",confirmButtonText:"ok"});return false}else{var c=[];if(d.schedule){c.schedule=$.parseJSON(d.schedule)[0]}else{c.schedule=null}if(d.messages){c.messages=$.parseJSON(d.messages)}else{c.messages=null}if(d.event_type){c.event_type=$.parseJSON(d.event_type)[0]}else{c.event_type=null}if(d.users){c.users=$.parseJSON(d.users)}else{c.users=null}if(d.custom_address){c.custom_address=$.parseJSON(d.custom_address)[0]}else{c.custom_address=null}if(d.meeting_room){c.meeting_room=$.parseJSON(d.meeting_room)[0]}else{c.meeting_room=null}if(d.created_by){c.created_by=d.created_by}else{c.created_by=null}fillEventData(c,b);if(c.custom_address){$("#event-defined-location-panel").slideUp();$("#event-custom-location-panel").slideDown()}if(!b.editable){$("form#schedule-form fieldset#main_fieldset").attr("disabled",true);$("#submit-btn").hide()}else{$("form#schedule-form fieldset#main_fieldset").removeAttr("disabled");$("#submit-btn").show()}setEventFormAccess(true);setMeetingRoomHeadquarter();$("#addScheduleFormModal").modal("show")}}})}function moveEvent(a,b){swal({title:"Czy na pewno zmienić termin zdarzenia?",type:"warning",showCancelButton:true,confirmButtonText:"Tak, zmień!",confirmButtonColor:"#DD6B55",cancelButtonText:"Nie",closeOnConfirm:false},function(c){if(c){$.ajax(a,{dataType:"json",method:"POST",data:{id:b.id,start:b.start.format(),end:b.end.format(),csrfmiddlewaretoken:csrf_token},success:function(d){if(d.status!="OK"){swal({title:"Błąd!",text:d.errMSG,type:"error",confirmButtonText:"ok"})}else{swal("Termin zdarzenia został zmieniony!","","success")}},complete:function(){$("#calendar").fullCalendar("refetchEvents")}})}else{$("#calendar").fullCalendar("refetchEvents")}})}function confirmEvent(b,a,c){swal({title:"Czy na pewno potwierdzić uczestnictwo?",type:"warning",showCancelButton:true,confirmButtonText:"Tak, potwierdź!",confirmButtonColor:"#DD6B55",cancelButtonText:"Nie",closeOnConfirm:false},function(){$.ajax("/schedule/schedule-participant-confirm/",{method:"POST",data:{id_schedule:b,id_user:a,csrfmiddlewaretoken:window.csrf_token},complete:function(e){var d=e.responseJSON;if(d.status!="OK"){swal({title:"Błąd!",text:d.message,type:"error",confirmButtonText:"ok"});return}if(c){c.switchClass("fa-times","fa-check");c.parents("tr").find('input[name="users-invited_users_confirmed"]').val(1)}$("#calendar").fullCalendar("refetchEvents");swal("Uczestnictwo zostało potwierdzone!","","success")}})})}function rejectEvent(b,a,c){swal({title:"Czy na pewno anulować uczestnictwo?",type:"warning",showCancelButton:true,confirmButtonText:"Tak, anuluj!",confirmButtonColor:"#DD6B55",cancelButtonText:"Nie",closeOnConfirm:false},function(){$.ajax("/schedule/schedule-participant-reject/",{method:"POST",data:{id_schedule:b,id_user:a,csrfmiddlewaretoken:window.csrf_token},complete:function(e){var d=e.responseJSON;if(d.status!="OK"){swal({title:"Błąd!",text:d.message,type:"error",confirmButtonText:"ok"});return}else{if(c){c.switchClass("fa-check","fa-times");c.parents("tr").find('input[name="users-invited_users_confirmed"]').val(0)}$("#calendar").fullCalendar("refetchEvents");swal("Uczestnictwo zostało anulowane!","","success")}}})})}function closeEvent(b,a){swal({title:"Czy na pewno zamknąć zdarzenie?",type:"warning",showCancelButton:true,confirmButtonText:"Tak, zamknij!",confirmButtonColor:"#DD6B55",cancelButtonText:"Nie",closeOnConfirm:false},function(){$.ajax("/schedule/schedule-close/",{method:"POST",data:{id_schedule:b,id_user:a,csrfmiddlewaretoken:window.csrf_token},complete:function(d){var c=d.responseJSON;if(c.status!="OK"){swal({title:"Błąd!",text:c.message,type:"error",confirmButtonText:"ok"});return}else{$("#calendar").fullCalendar("refetchEvents");swal("Zdarzenie zostało zamknięte!","","success")}}})})}function statusEvent(d,b,c,a,e){swal({title:"Czy na pewno kontynuować?",type:"warning",showCancelButton:true,confirmButtonText:"Tak!",confirmButtonColor:"#DD6B55",cancelButtonText:"Nie",closeOnConfirm:false},function(){$.ajax("/schedule/schedule-status/",{method:"POST",data:{id_schedule:d,id_user:b,status:c,csrfmiddlewaretoken:window.csrf_token},complete:function(g){var f=g.responseJSON;if(f.status!="OK"){swal({title:"Błąd!",text:f.errmsg,type:"error",confirmButtonText:"ok"})}else{$("#calendar").fullCalendar("refetchEvents");if(a){$("#addScheduleFormModal").modal("toggle")}if(e){e()}swal("Zmiana wykonana pomyślnie!","","success")}}})})}function deleteEvent(a){swal({title:"Czy na pewno usunąć zdarzenie?",type:"warning",showCancelButton:true,confirmButtonText:"Tak, usuń!",confirmButtonColor:"#DD6B55",cancelButtonText:"Nie",closeOnConfirm:false},function(){$.ajax("/schedule/schedule-delete/",{method:"POST",data:{id:a,csrfmiddlewaretoken:window.csrf_token},complete:function(c){var b=c.responseJSON;if(b.status!="OK"){swal({title:"Błąd!",text:b.message,type:"error",confirmButtonText:"ok"});return}else{$("#calendar").fullCalendar("removeEvents",a);swal("Zdarzenie zostało usunięte!","","success")}}})})}function toggleParticipantConfirmation(d){var a=d.closest("tr").data("id");var b=$("form#schedule-form #id").val();var c=d.hasClass("fa-times");if(c){confirmEvent(b,a,d)}else{rejectEvent(b,a,d)}};