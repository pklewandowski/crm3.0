var calendar_mode="event";function getUserFromIframe(){alert("getUserFromIframe")}$(document).ready(function(){$(document).keyup(function(a){if(a.keyCode===27){$(".tooltip").tooltip("hide");$(".popover").popover("hide")}});$("#datepicker11").datetimepicker({locale:"pl",inline:true,format:"YYYY-MM-DD"});$("#datepicker11").on("dp.change",function(a){$("#calendar").fullCalendar("gotoDate",a.date.format("YYYY-MM-DD"))});$("#addScheduleFormModal").modal({keyboard:false,backdrop:"static",show:false});$("#scheduleFilterModal").modal({keyboard:false,backdrop:"static",show:false});$(document).on("click","#submit-btn",function(){$("form#schedule-form").submit()});$(document).on("click","#confirm-btn",function(){confirmEvent($("form#schedule-form #id").val(),$("form#schedule-form #id_user").val())});$(document).on("click","#reject-btn",function(){rejectEvent($("form#schedule-form #id").val(),$("form#schedule-form #id_user").val())});$(document).on("click",".suggestion-list li.user-list",function(){var b;var a=[];$.each($(this).data(),function(c,d){a[c]=d});$("#suggestion-box").hide();swal({title:"Typ uczestnictwa",text:"Wybierz typ uczestnictwa",type:"info",showCancelButton:true,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Prowadzący",cancelButtonText:"Uczestnik",confirmButtonClass:"btn btn-default",cancelButtonClass:"btn btn-default",buttonsStyling:false},function(c){if(!c){b="P"}else{b="L"}a.participant_type=b;a.active=false;if($("form#schedule-form #id_schedule-type option:selected").data("exclusive_participant_mode")==="True"){a.exclusive_participant_mode=true}else{a.exclusive_participant_mode=false}$("#event-user-list-row-table tbody").append(fillParticipantList(a));$("#search-box").val(null)})});$(document).on("click","#event-user-list-row-table > tbody > tr a.delete",function(){var a=$(this);swal({title:"Jesteś pewien?",type:"warning",showCancelButton:true,confirmButtonText:"Tak, usuń uczestnika!",confirmButtonColor:"#DD6B55",cancelButtonText:"Nie",closeOnConfirm:true},function(){a.parents("tr").remove();swal("Użytkownik został usunięty!","","success")})});$(document).on("keyup","#search-box",function(b){var a=[];$("#event-user-list-row-table").find("tbody > tr").each(function(){a.push(parseInt($(this).data("id")))});$("#suggestion-box").html(null);$.ajax({type:"POST",url:window.calendar.ajxUserListUrl,data:{key:$(this).val(),csrfmiddlewaretoken:window.csrf_token,id:JSON.stringify(a)},beforeSend:function(){},success:function(c){if(c.status==="ERROR"){alert(c.message);return}if(!c.hasOwnProperty("data")){return}let userList=$.parseJSON(c.data);let html="<ul>";for(let i in userList){html+='<li class="user-list" ';html+='data-id="'+userList[i].pk+'" ';html+='data-first_name="'+userList[i].fields.first_name+'" ';html+='data-last_name="'+userList[i].fields.last_name+'" ';html+='data-email="'+userList[i].fields.email+'" ';html+='data-phone_one="'+userList[i].fields.phone_one+'" ';html+='data-phone_two="'+userList[i].fields.phone_two+'" ';html+='data-confirmed="false" ';html+=">"+userList[i].fields.first_name+" "+userList[i].fields.last_name+"</li>"}html+="</ul>";let suggestion_box=$("#suggestion-box");suggestion_box.html(html);suggestion_box.show();$("#search-box").css("background","#FFFFFF")}})});$(document).on("change","#id_schedule-headquarter",function(){$(".meeting-room-select-buttons .headquarter-meeting_room-container").hide();$(".meeting-room-select-buttons #headquarter_"+$(this).val()).fadeIn(500)});$("#id_employee-user").select2({ajax:{method:"post",url:"/schedule/get-clients-for-meeting-filter/",dataType:"json"},minimumInputLength:2,language:"pl"});$("#id_filter-user").select2({ajax:{method:"post",url:"/schedule/get-users-for-meeting-filter/",dataType:"json"},minimumInputLength:2,language:"pl"});$("#id_filter-employee").select2({ajax:{method:"post",url:"/schedule/get-employees-for-meeting-filter/",dataType:"json"},minimumInputLength:2,language:"pl"});$("#"+schedule_type_id).change(function(){var a=$(this).find(":selected");if(a.data("single_person")==="True"){$(".users-panel").hide(200)}else{$(".users-panel").show(200)}if(a.data("location_required")==="False"){$(".location-panel").hide(200)}else{$(".location-panel").show(200)}if(a.data("title_required")==="False"){$("#id_title").prop("disabled",true);if(a.data("default_title")){$("#id_title").data("default_title","True");$("#id_title").val(a.data("default_title"))}}else{$("#id_title").prop("disabled",false);if($("#id_title").data("default_title")==="True"){$("#id_title").val(null)}$("#id_title").data("default_title","False")}});$("#scheduleFilterModal #filter-btn").click(function(a){refetchEvents();$("#scheduleFilterModal").modal("toggle")});$(document).on("shown.bs.collapse","#eventLocationCollapse",function(){google.maps.event.trigger(map,"resize")});$(document).on("submit","form#schedule-form",function(b){b.preventDefault();var a=$("#schedule-form");a.find(".form-field-error").removeClass("form-field-error");a.find("ul.errorlist").remove();a.find("#error_list").text(null).hide();create_post()});$("#delete-btn").click(function(){deleteEvent($("form#schedule-form #id").val())});$(document).on("change","form#schedule-form #id_schedule-type",function(){setEventFormAccess(false)});$(document).on("change","#toggle_all_types_chk",function(){$(".event-type-chk").attr("checked",$(this).is(":checked"))});$(document).on("click","#event-user-list-row-table tbody tr a.participant-confirmation i.active",function(){toggleParticipantConfirmation($(this))});$(document).on("click","form#schedule-form #close-btn",function(){statusEvent($("form#schedule-form #id").val(),window.id_user,"CL",true)});$(document).on("click","form#schedule-form #cancel-btn",function(){statusEvent($("form#schedule-form #id").val(),window.id_user,"AN",true)});$(document).on("click","form#schedule-form #cancel_and_set-btn",function(){var a=$("form#schedule-form");statusEvent(a.find("#id").val(),window.id_user,"AN",false,function(){a.find("#cancel-btn").hide();a.find("#cancel_and_set-btn").hide();a.find("#close-btn").hide();a.find("#delete-btn").hide();a.find("#activate-btn").hide();a.find("input#id").val(null);a.find("input#id_schedule-start_date").val(null);a.find("#start_date").val("09:00");a.find("input#id_schedule-end_date").val(null);a.find("#end_date").val("17:00")})});$(document).on("click","form#schedule-form #activate-btn",function(){statusEvent($("form#schedule-form #id").val(),window.id_user,"NW",true)});$(document).on("click","form#schedule-form #delete-btn",function(){statusEvent($("form#schedule-form #id").val(),window.id_user,"DL",true)});$(document).on("click",".suggestion-list ul.user-func li",function(){$.fancybox.open({href:$("#add_user_btn").data("url")+$(this).data("type")+"/?iframe=1",type:"iframe",padding:5,helpers:{overlay:{closeClick:false}}})});$(document).on("change",'input:radio[name="schedule-meeting_room"]',function(){if($(this).closest("label").hasClass("disabled")){return false}$("#defined_location_title").text($(this).data("name"));$("#defined_location_title").data("id",$(this).val())});$(document).on("click","#custom_location-btn",function(){$("#defined_location_title").text(null);$("#defined_location_title").data("id",$("input[name='schedule-meeting_room']:checked").val());$("form#schedule-form input[name='schedule-meeting_room']").prop("checked",false);$("form#schedule-form input[name='schedule-meeting_room']").closest("label").removeClass("active");$("#event-defined-location-panel").slideUp();$("#event-custom-location-panel").slideDown();google.maps.event.trigger(map,"resize")});$(document).on("click","#defined_location-btn",function(){var a=$("#defined_location_title").data("id");if(a){$("input[name='schedule-meeting_room']").each(function(){if($(this).val()==a){$(this).prop("checked",true);$(this).closest("label").addClass("active");$("#defined_location_title").data("id",null);$("#defined_location_title").text($(this).data("name"));clear_form_elements("#custom-location-address");return false}})}$("#event-defined-location-panel").slideDown();$("#event-custom-location-panel").slideUp()});$(document).on("change",'form#schedule-form input[name="users-invited_users_exclusive_participant_mode_label"]',function(){if($(this).is(":checked")){$(this).closest("tr").find('input[name="users-invited_users_exclusive_participant_mode"]').val("1")}else{$(this).closest("tr").find('input[name="users-invited_users_exclusive_participant_mode"]').val("0")}});$(document).on("click","a#add_event_message_btn",function(){$("#event_message_text_container").slideDown()});$("#filter_form_btn").click(function(){getAvailableDates()});$(document).on("click","#available_date_list a",function(){var a=$(this).data("date");$("#calendar").fullCalendar("gotoDate",a);$("#available_date_modal").modal("hide")});$("#available_date_reset_btn").click(function(){clear_form_elements($("#available_date_form"));calendar_mode="event";$("#calendar").fullCalendar("refetchEvents");$("#calendar").fullCalendar("gotoDate",Date.now());$("#calendar").fullCalendar("refetchEvents");$("#available_date_form").find("#id_filter-min_duration option:first").prop("selected",true);$("#available_date_reset_btn").hide()});$(document).on("click","#mode_toggle_btn",function(){$(this).unbind("click");var a=$("form#schedule-form #basic_form_container").is(":visible")?"advanced":"basic";$("#form_content").hide({duration:"slow",complete:function(){getFormContent(a);initMap();$("#form_content").show("slow")}})})});